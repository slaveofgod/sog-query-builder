!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.sogqb=t()}(this,function(){!function(){for(var e={},t=["Array","Object","Function","Date","RegExp","Float32Array"],i=0;i<t.length;i++)e["[object "+t[i]+"]"]=t[i].toLowerCase()}();var s={version:"0.0.1",revision:"db86ca4",config:{stateElementTypes:["expression","conjunction"],expressionOperators:[{key:"equal",label:"Equal"},{key:"not_equal",label:"Not Equal"},{key:"more",label:"More"},{key:"more_or_equal",label:"More or Equal"},{key:"less",label:"Less"},{key:"less_or_equal",label:"less_or_equal"},{key:"like",label:"Like"}],conjunctionOperators:[{key:"or",label:"Or"},{key:"and",label:"And"}]},common:{},themes:{},registerTheme:function(t){var e=new[t][0]({},{},!0),i=e.alias;if(void 0===i)throw new Error('The theme has to have "alias" property');if("AbstractTheme"!==e.base)throw new Error('The theme has to extend "sogqb.AbstractTheme" abstract class');if(void 0===e.__draw)throw new Error('The theme has to implement "__draw" method');if(!1===sogv.isType("string",i)&&!1===sogv.isType("array",i))throw new Error('The alias must be type of "string" or "array", "'+sogv.getType(i)+'" given');"string"==typeof i&&(i=[i]),i.forEach(function(e){void 0===s.themes[t]&&(s.themes[e]=t)})},makeTheme:function(e,t,i,n){if(void 0===s.themes[e])throw new Error('Theme with alias "'+e+'" is not registered.');return new s.themes[e](t,i,n)},makeScheme:function(e){return new s.Scheme(e)},makeState:function(e,t){return new s.State(e,t)},isValidException:function(e,t,i){var n=sogv.isValidWithErrorMessage(t,i);if(null!==n)throw new Error(e+": "+n);return!0}};function e(e,t,i){this.__options=e||{},this.__internal=!0===i,(this.__skipDrawing=!1)===this.__internal&&this.__validateOptions(t),this.name="AbstractTheme",this.base="AbstractTheme"}function t(e){this.__scheme=e||null,this.__validate(),this.name="Scheme"}function i(e,t){this.__state=e||null,this.__scheme=t||null,null!==this.__state&&this.__validate(),this.name="State"}function n(e,t,i,n,r){var a=this;this.__container=e||null,this.__entity=t||null,this.__scheme=i||null,this.__state=n||null,this.__theme=r||"material",s.isValidException("Container",this.__container,"required|string|length:5,255"),s.isValidException("Entity",this.__entity,"required|string|length:2,50"),this.setScheme(this.__scheme),this.setTheme(this.__theme),this.setState(this.__state,this.__scheme),this.name="Application",window.addEventListener("resize",function(){a.update()})}function r(e,t,i){s.AbstractTheme.call(this,e,{container:t.container||"required|string|length:5,255"},i),this.__queryButton='<div class="query" contentEditable=true data-text="Searching Filter"></div>',this.__searchButton='<button class="btn btn-default waves-effect btn-super-sm float-right search"><i class="zmdi zmdi-search"></i></button>',this.__clearButton='<button class="btn btn-default waves-effect btn-super-sm float-right clear"><i class="zmdi zmdi-close"></i></button>',this.container=this.__options.container,this.cssStyles=this.__prepareCssStyles("#%%container%%{height:36px;border:1px solid #5E5E5E;font-size:16px;}#%%container%% .query{height:34px;float:left;width:10px;padding:4px 0 4px 6px;}#%%container%% button.float-left{margin:3px 0 3px 3px;float:left;}#%%container%% button.float-right{margin:3px 3px 3px 0;float:right;}#%%container%% .btn-group-sm > .btn, .btn-super-sm{padding:3px 10px;font-size:14px;line-height:1.5;border-radius:2px;text-transform:none;}#%%container%% [contentEditable=true]:empty:not(:focus):before{content:attr(data-text);opacity:.5;}"),this.name="MaterialTheme"}return"undefined"!=typeof exports&&(exports.sogqb=s),Object.assign(s,(Object.assign(e.prototype,{draw:function(){this.__beforeDraw(),!1===this.__skipDrawing&&(console.info('Drawing this container with the id "'+this.container+'" ...'),this.__draw()),this.__afterDraw()},update:function(){this.__destroy(),this.draw()},__draw:function(){throw new Error('The theme has to implement "__draw" method')},__beforeDraw:function(){null===document.getElementById(this.container)&&(this.__skipDrawing=!0,console.info('This container with the id "'+this.container+'" does not exist.'))},__afterDraw:function(){},__destroy:function(){document.getElementById(this.container).innerHTML=""},__validateOptions:function(e){if(null!=e)for(var t in e)e.hasOwnProperty(t)&&s.isValidException("[option: "+t+"]",this.__options[t],e[t])},__prepareCssStyles:function(e){var t={container:this.container};for(var i in t)t.hasOwnProperty(i)&&(e=e.replace(new RegExp("%%"+i+"%%","gm"),t[i]));return e},__buildStyleElement:function(){var e=document.getElementById(this.container),t=document.createElement("style");t.innerHTML=this.cssStyles,e.appendChild(t)},__buildContainerElement:function(){var e=document.getElementById(this.container),t=this.__buildElement("query"),i=this.__buildElement("search"),n=this.__buildElement("clear");e.appendChild(t),e.appendChild(i),e.appendChild(n)},__prettify:function(){var e=document.getElementById(this.container),t=e.clientWidth-10;e.childNodes.forEach(function(e){!1===e.classList.contains("query")&&(t-=e.clientWidth)}),e.querySelector(".query").style.width=t+"px"},__buildElement:function(e){var t=document.createElement("template"),i="";switch(e){case"query":i=this.__queryButton.trim();break;case"search":i=this.__searchButton.trim();break;case"clear":i=this.__clearButton.trim()}return t.innerHTML=i,t.content.firstChild}}),{AbstractTheme:e})),Object.assign(s,(t.prototype.constructor=t,Object.defineProperties(t.prototype,{scheme:{get:function(){return this.__scheme}}}),Object.assign(t.prototype,{__validate:function(){s.isValidException("Scheme",this.__scheme,"required|array|count:1,100");for(var e=0;e<this.__scheme.length;e++)this.__validateEntity(this.__scheme[e].entity),this.__validateColumns(this.__scheme[e].columns);return!0},__validateEntity:function(e){return s.isValidException("Entity",e,"required|string|alpha-dash|length:2,50"),!0},__validateColumns:function(e){return s.isValidException("Columns",e,"required|array|between:1,1000"),e.forEach(function(e){var t=new sogv.Application({lang:"en"}),i={name:e.name,title:e.title,type:e.type,data:e.data},n=t.make(i,{name:"required|string|alpha-dash|length:2,50",title:"required|string|print|length:2,100",type:"required|in:email;integer;numeric;string;date",data:"array"});if(!1===n.isValid())for(var r in i)if(i.hasOwnProperty(r)&&!1===n.get(r).isValid())throw new Error("Column '"+r+"' = '"+i[r]+"': "+n.get(r).errors().first())}),!0}}),{Scheme:t})),Object.assign(s,(i.prototype.constructor=i,Object.defineProperties(i.prototype,{state:{get:function(){return this.__state}}}),Object.assign(i.prototype,{__validate:function(){s.isValidException("State",this.__state,"required|array|count:1,100");for(var e=0;e<this.__state.length;e++){s.isValidException("State > Type",this.__state[e].type,"required|alnum|in:"+s.config.stateElementTypes.join(";"));var t=new sogv.Application({lang:"en"}),i={},n={};switch(this.__state[e].type){case"expression":i={field:this.__state[e].field,label:this.__state[e].label,value:this.__state[e].value,operator:this.__state[e].operator},n={field:"required|regex:^[a-zA-Z0-9_-]+.[a-zA-Z0-9_-]+$",label:"required|string",value:"required|string",operator:"required|alnum|in:"+s.config.expressionOperators.map(function(e){return e.key}).join(";")};break;case"conjunction":i={operator:this.__state[e].operator},n={operator:"required|alnum|in:"+s.config.conjunctionOperators.map(function(e){return e.key}).join(";")}}var r=t.make(i,n);if(!1===r.isValid())for(var a in i)if(i.hasOwnProperty(a)&&!1===r.get(a).isValid())throw new Error(sogh.camelCase(this.__state[e].type)+" '"+a+"' = '"+i[a]+"': "+r.get(a).errors().first())}return!0}}),{State:i})),Object.assign(s,(n.prototype.constructor=n,Object.defineProperties(n.prototype,{container:{get:function(){return this.__container}},entity:{get:function(){return this.__entity}},scheme:{get:function(){return this.__scheme}},state:{get:function(){return this.__state}},theme:{get:function(){return this.__theme}}}),Object.assign(n.prototype,{setScheme:function(e){this.__scheme=s.makeScheme(e)},setState:function(e,t){void 0!==e&&(t=this.__state),this.__state=s.makeState(e,t)},setTheme:function(e){this.__theme=s.makeTheme(e,{container:this.container},{})},draw:function(){this.__theme.draw()},update:function(){this.__theme.update()}}),{Application:n})),Object.assign(s,((r.prototype=Object.create(s.AbstractTheme.prototype)).constructor=r,Object.defineProperty(r.prototype,"alias",{get:function(){return["material"]}}),Object.assign(r.prototype,{__draw:function(){this.__buildStyleElement(),this.__buildContainerElement(),this.__prettify()}}),{MaterialTheme:r})),s.registerTheme(s.MaterialTheme),s});